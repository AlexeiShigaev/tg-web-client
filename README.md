# tg-web-client
Это не бот. Это клиент телеграм. Точнее стартовый каркас.
Использовано: thelethon, asyncio, pydantic, poetry

## В общих словах
После запуска, открываем в браузере страницу http://localhost:8899. 
Для авторизации указываем номер телефона. Будет предъявлен QR-code. 
В смартфоне в телеграм идем в Настройки/Устройства/Подключить устройство.

После авторизации загрузится клиентская страница, список контактов и последние 10 сообщений для каждого из них.

## Запуск

```
git pull
python -m venv .venv
python . ./.venv/bin/activate
pip install --upgrade pip poetry
poetry install
```

Создайте новое приложение в https://my.telegram.org/ и получите API ID и API HASH.<br>
Необходимо вставить свои данные в строки в mytelethon/src/api/tgclient.py
```
TELEGRAM_API_ID = 10042
TELEGRAM_API_HASH = "46d123321325f70b93e7ba"
```
далее
```
python src/main.py
```

## Уточнения

Метод **stringify()** дает не совсем корректный результат для **telethon.tl.types.Dialog**. 
Например, при разборе диалогов, получается два ключа 'message', что для словаря не есть хорошо.
Собрал свою реализацию **dialog_to_dict()** в **src/api/utils.py**, 
результат меня устроил больше, чем расхожий **to_dict_req()** из интернетов.
При этом, есть соблазн использовать eval, для преобразования данных в namedtuple. (Дыра в безопасности, спору нет.)
Не нравится двойное преобразование: во-первых **telethon.tl.types.Dialog** в строку (или в dict), 
потом еще во что-то..., хотя в таблицы в базу все равно нужно сохранять некую модель. Посмотрим.
